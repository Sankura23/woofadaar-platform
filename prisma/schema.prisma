generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model ABTest {
  id                String              @id
  test_name         String              @unique
  description       String?
  start_date        DateTime
  end_date          DateTime?
  variant_a_config  Json
  variant_b_config  Json
  target_metric     String
  status            String              @default("active")
  created_at        DateTime            @default(now())
  updated_at        DateTime            @default(now())
  ABTestParticipant ABTestParticipant[]

  @@index([end_date])
  @@index([start_date])
  @@index([status])
}

model ABTestParticipant {
  id               String    @id
  test_id          String
  user_id          String
  variant          String
  assigned_at      DateTime  @default(now())
  converted        Boolean   @default(false)
  conversion_at    DateTime?
  conversion_value Float?
  ABTest           ABTest    @relation(fields: [test_id], references: [id], onDelete: Cascade)
  User             User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([test_id, user_id])
  @@index([converted])
  @@index([test_id])
  @@index([user_id])
  @@index([variant])
}

model AIRecommendation {
  id                  String    @id
  user_id             String
  dog_id              String?
  recommendation_type String
  title               String
  description         String
  confidence_score    Float
  data_sources        Json
  action_url          String?
  priority            String    @default("medium")
  status              String    @default("active")
  expires_at          DateTime?
  created_at          DateTime  @default(now())
  updated_at          DateTime  @default(now())
  Dog                 Dog?      @relation(fields: [dog_id], references: [id])
  User                User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([dog_id])
  @@index([expires_at])
  @@index([priority])
  @@index([recommendation_type])
  @@index([status])
  @@index([user_id])
}

model Answer {
  id                 String   @id
  question_id        String
  user_id            String
  content            String
  upvotes            Int      @default(0)
  is_expert_verified Boolean  @default(false)
  created_at         DateTime @default(now())
  Question           Question @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User               User     @relation(fields: [user_id], references: [id])
}

model Appointment {
  id                String              @id
  partner_id        String
  user_id           String
  dog_id            String?
  appointment_date  DateTime
  duration_minutes  Int                 @default(60)
  service_type      String
  status            String              @default("scheduled")
  notes             String?
  consultation_fee  Float?
  payment_status    String              @default("pending")
  meeting_type      String              @default("in_person")
  meeting_link      String?
  created_at        DateTime            @default(now())
  updated_at        DateTime
  Dog               Dog?                @relation(fields: [dog_id], references: [id])
  Partner           Partner             @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  User              User                @relation(fields: [user_id], references: [id])
  CommissionEarning CommissionEarning[]
  PartnerReview     PartnerReview[]

  @@index([appointment_date])
  @@index([partner_id])
  @@index([status])
  @@index([user_id])
}

model AuditLog {
  id         String   @id
  user_id    String
  action     String
  details    Json?
  created_at DateTime @default(now())
  User       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model BreedHealthInsight {
  id                    String   @id
  breed                 String
  age_group             String
  common_conditions     String[]
  preventive_care       Json
  nutrition_guidelines  Json
  exercise_requirements Json
  grooming_needs        Json
  seasonal_concerns     Json
  lifespan_data         Json
  health_monitoring     Json
  created_at            DateTime @default(now())
  updated_at            DateTime

  @@unique([breed, age_group])
  @@index([age_group])
  @@index([breed])
}

model CommissionEarning {
  id                String       @id
  partner_id        String
  user_id           String
  appointment_id    String?
  commission_type   String
  base_amount       Float
  commission_rate   Float
  commission_amount Float
  status            String       @default("pending")
  paid_at           DateTime?
  created_at        DateTime     @default(now())
  Appointment       Appointment? @relation(fields: [appointment_id], references: [id])
  Partner           Partner      @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  User              User         @relation(fields: [user_id], references: [id])

  @@index([commission_type])
  @@index([created_at])
  @@index([partner_id])
  @@index([status])
}

model CommunityAnalytics {
  id               String   @id
  date             DateTime
  metric_type      String
  category         String?
  language         String   @default("en")
  count            Int      @default(0)
  engagement_score Float?
  quality_score    Float?
  created_at       DateTime @default(now())

  @@unique([date, metric_type, category, language])
  @@index([date])
  @@index([language])
  @@index([metric_type])
}

model CommunityAnswer {
  id                 String             @id
  question_id        String
  user_id            String
  content            String
  is_best_answer     Boolean            @default(false)
  upvotes            Int                @default(0)
  downvotes          Int                @default(0)
  is_verified_expert Boolean            @default(false)
  photo_url          String?
  status             String             @default("active")
  created_at         DateTime           @default(now())
  updated_at         DateTime           @default(now())
  CommunityQuestion  CommunityQuestion  @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User               User               @relation(fields: [user_id], references: [id])
  CommunityComment   CommunityComment[]
  CommunityFlag      CommunityFlag[]
  CommunityVote      CommunityVote[]

  @@index([created_at])
  @@index([is_best_answer])
  @@index([question_id])
  @@index([status])
  @@index([user_id])
}

model CommunityComment {
  id                String             @id
  user_id           String
  question_id       String?
  answer_id         String?
  forum_post_id     String?
  content           String
  upvotes           Int                @default(0)
  downvotes         Int                @default(0)
  status            String             @default("active")
  created_at        DateTime           @default(now())
  updated_at        DateTime           @default(now())
  CommunityAnswer   CommunityAnswer?   @relation(fields: [answer_id], references: [id], onDelete: Cascade)
  ForumPost         ForumPost?         @relation(fields: [forum_post_id], references: [id], onDelete: Cascade)
  CommunityQuestion CommunityQuestion? @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User              User               @relation(fields: [user_id], references: [id])
  CommunityFlag     CommunityFlag[]

  @@index([answer_id])
  @@index([created_at])
  @@index([forum_post_id])
  @@index([question_id])
  @@index([status])
  @@index([user_id])
}

model CommunityExpert {
  id                                     String    @id
  user_id                                String
  partner_id                             String?
  expertise_areas                        String[]
  verification_status                    String    @default("pending")
  verification_date                      DateTime?
  verified_by                            String?
  bio                                    String?
  years_experience                       Int?
  certifications                         String[]
  specializations                        String[]
  is_featured                            Boolean   @default(false)
  answer_count                           Int       @default(0)
  best_answer_count                      Int       @default(0)
  total_points                           Int       @default(0)
  created_at                             DateTime  @default(now())
  updated_at                             DateTime  @default(now())
  Partner                                Partner?  @relation(fields: [partner_id], references: [id])
  User_CommunityExpert_user_idToUser     User      @relation("CommunityExpert_user_idToUser", fields: [user_id], references: [id])
  User_CommunityExpert_verified_byToUser User?     @relation("CommunityExpert_verified_byToUser", fields: [verified_by], references: [id])

  @@index([expertise_areas])
  @@index([is_featured])
  @@index([partner_id])
  @@index([user_id])
  @@index([verification_status])
}

model CommunityFlag {
  id                                    String             @id
  user_id                               String
  question_id                           String?
  answer_id                             String?
  comment_id                            String?
  forum_post_id                         String?
  reason                                String
  description                           String?
  status                                String             @default("pending")
  moderator_id                          String?
  moderator_notes                       String?
  created_at                            DateTime           @default(now())
  resolved_at                           DateTime?
  CommunityAnswer                       CommunityAnswer?   @relation(fields: [answer_id], references: [id], onDelete: Cascade)
  CommunityComment                      CommunityComment?  @relation(fields: [comment_id], references: [id], onDelete: Cascade)
  ForumPost                             ForumPost?         @relation(fields: [forum_post_id], references: [id], onDelete: Cascade)
  User_CommunityFlag_moderator_idToUser User?              @relation("CommunityFlag_moderator_idToUser", fields: [moderator_id], references: [id])
  CommunityQuestion                     CommunityQuestion? @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User_CommunityFlag_user_idToUser      User               @relation("CommunityFlag_user_idToUser", fields: [user_id], references: [id])

  @@index([answer_id])
  @@index([comment_id])
  @@index([created_at])
  @@index([forum_post_id])
  @@index([question_id])
  @@index([status])
  @@index([user_id])
}

model CommunityQuestion {
  id               String             @id
  user_id          String
  dog_id           String?
  title            String
  content          String
  tags             String[]
  category         String
  is_resolved      Boolean            @default(false)
  best_answer_id   String?
  view_count       Int                @default(0)
  upvotes          Int                @default(0)
  downvotes        Int                @default(0)
  answer_count     Int                @default(0)
  is_pinned        Boolean            @default(false)
  is_featured      Boolean            @default(false)
  status           String             @default("active")
  photo_url        String?
  location         String?
  created_at       DateTime           @default(now())
  updated_at       DateTime           @default(now())
  CommunityAnswer  CommunityAnswer[]
  CommunityComment CommunityComment[]
  CommunityFlag    CommunityFlag[]
  Dog              Dog?               @relation(fields: [dog_id], references: [id])
  User             User               @relation(fields: [user_id], references: [id])
  CommunityVote    CommunityVote[]
  QuestionView     QuestionView[]

  @@index([category])
  @@index([created_at])
  @@index([dog_id])
  @@index([is_resolved])
  @@index([status])
  @@index([tags])
  @@index([user_id])
}

model CommunityTrending {
  id               String   @id
  content_id       String
  content_type     String
  trend_score      Float
  view_velocity    Float
  engagement_score Float
  time_period      String
  language         String   @default("en")
  category         String?
  location         String?
  created_at       DateTime @default(now())
  expires_at       DateTime

  @@index([category])
  @@index([content_type])
  @@index([created_at])
  @@index([expires_at])
  @@index([language])
  @@index([time_period])
  @@index([trend_score])
}

model CommunityVote {
  id                String             @id
  user_id           String
  question_id       String?
  answer_id         String?
  vote_type         String
  created_at        DateTime           @default(now())
  CommunityAnswer   CommunityAnswer?   @relation(fields: [answer_id], references: [id], onDelete: Cascade)
  CommunityQuestion CommunityQuestion? @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User              User               @relation(fields: [user_id], references: [id])

  @@unique([user_id, answer_id])
  @@unique([user_id, question_id])
  @@index([answer_id])
  @@index([question_id])
  @@index([user_id])
  @@index([vote_type])
}

model Company {
  id                 String               @id
  name               String
  email_domain       String               @unique
  industry           String?
  employee_count     Int?
  address            String?
  billing_address    String?
  contact_person     String?
  contact_email      String?
  contact_phone      String?
  logo_url           String?
  subscription_tier  String               @default("basic")
  billing_cycle      String               @default("monthly")
  status             String               @default("active")
  created_at         DateTime             @default(now())
  updated_at         DateTime             @default(now())
  CorporateAdmin     CorporateAdmin[]
  CorporateBilling   CorporateBilling[]
  Dog                Dog[]
  EmployeeEnrollment EmployeeEnrollment[]

  @@index([email_domain])
  @@index([status])
  @@index([subscription_tier])
}

model ComplianceAudit {
  id                   String    @id
  audit_type           String
  entity_type          String
  entity_id            String
  compliance_status    String
  audit_details        Json      @default("{}")
  risk_score           Int       @default(0)
  remediation_required Boolean   @default(false)
  remediation_deadline DateTime?
  remediated_at        DateTime?
  auditor_id           String?
  created_at           DateTime  @default(now())
  User                 User?     @relation(fields: [auditor_id], references: [id])

  @@index([compliance_status])
  @@index([created_at])
  @@index([entity_type, entity_id])
  @@index([risk_score])
}

model ConsultationCredit {
  id                String        @id
  user_id           String
  credit_type       String
  credits_total     Int
  credits_used      Int           @default(0)
  credits_remaining Int
  expires_at        DateTime?
  issued_at         DateTime      @default(now())
  issued_reason     String?
  subscription_id   String?
  metadata          Json?
  Subscription      Subscription? @relation(fields: [subscription_id], references: [id])
  User              User          @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([credit_type])
  @@index([expires_at])
  @@index([issued_at])
  @@index([subscription_id])
  @@index([user_id])
}

model ContentRecommendation {
  id                   String    @id
  user_id              String
  content_type         String
  content_id           String
  recommendation_score Float
  reason               String?
  shown_at             DateTime?
  clicked_at           DateTime?
  dismissed_at         DateTime?
  created_at           DateTime  @default(now())
  User                 User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([content_type])
  @@index([created_at])
  @@index([recommendation_score])
  @@index([shown_at])
  @@index([user_id])
}

model CorporateAdmin {
  id              String            @id
  company_id      String
  user_id         String
  role            String            @default("admin")
  permissions     Json              @default("[]")
  created_at      DateTime          @default(now())
  Company         Company           @relation(fields: [company_id], references: [id], onDelete: Cascade)
  User            User              @relation(fields: [user_id], references: [id], onDelete: Cascade)
  PetBenefitClaim PetBenefitClaim[]

  @@index([company_id])
  @@index([user_id])
}

model CorporateBilling {
  id                   String    @id
  company_id           String
  billing_period_start DateTime  @db.Date
  billing_period_end   DateTime  @db.Date
  employee_count       Int
  pet_count            Int
  base_amount          Float
  discount_amount      Float     @default(0.00)
  tax_amount           Float     @default(0.00)
  total_amount         Float
  currency             String    @default("INR")
  status               String    @default("pending")
  invoice_url          String?
  payment_date         DateTime?
  created_at           DateTime  @default(now())
  Company              Company   @relation(fields: [company_id], references: [id], onDelete: Cascade)

  @@index([billing_period_start])
  @@index([company_id])
  @@index([status])
}

model CorporateEmployee {
  id                      String              @id
  corporate_enrollment_id String
  employee_email          String
  employee_name           String
  user_id                 String?
  pets_enrolled           Int                 @default(0)
  enrollment_date         DateTime            @default(now())
  status                  String              @default("active")
  CorporateEnrollment     CorporateEnrollment @relation(fields: [corporate_enrollment_id], references: [id], onDelete: Cascade)
  User                    User?               @relation(fields: [user_id], references: [id])

  @@unique([corporate_enrollment_id, employee_email])
  @@index([corporate_enrollment_id])
  @@index([employee_email])
  @@index([status])
}

model CorporateEnrollment {
  id                String              @id
  company_name      String
  company_email     String
  contact_person    String
  contact_phone     String
  employee_count    Int
  enrolled_pets     Int                 @default(0)
  package_type      String
  monthly_fee       Float
  status            String              @default("active")
  billing_cycle     String              @default("monthly")
  next_billing_date DateTime
  created_at        DateTime            @default(now())
  updated_at        DateTime
  CorporateEmployee CorporateEmployee[]

  @@index([company_email])
  @@index([package_type])
  @@index([status])
}

model Coupon {
  id                      String        @id
  code                    String        @unique
  name                    String
  description             String?
  type                    String
  value                   Float
  minimum_order_amount    Float?
  maximum_discount_amount Float?
  usage_limit             Int?
  usage_limit_per_user    Int?
  current_usage_count     Int           @default(0)
  valid_from              DateTime
  valid_until             DateTime
  applicable_plans        String[]
  first_time_users_only   Boolean       @default(false)
  is_active               Boolean       @default(true)
  created_by              String
  metadata                Json?
  created_at              DateTime      @default(now())
  updated_at              DateTime
  CouponUsage             CouponUsage[]

  @@index([created_by])
  @@index([is_active])
  @@index([type])
  @@index([valid_from])
  @@index([valid_until])
}

model CouponUsage {
  id              String        @id
  coupon_id       String
  user_id         String
  subscription_id String?
  order_amount    Float
  discount_amount Float
  used_at         DateTime      @default(now())
  metadata        Json?
  Coupon          Coupon        @relation(fields: [coupon_id], references: [id], onDelete: Cascade)
  Subscription    Subscription? @relation(fields: [subscription_id], references: [id])
  User            User          @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([coupon_id])
  @@index([subscription_id])
  @@index([used_at])
  @@index([user_id])
}

model DataSharingConsent {
  id                 String    @id
  user_id            String
  dog_id             String
  consent_type       String
  consent_status     String    @default("pending")
  consent_text       String
  consent_version    String
  granted_at         DateTime?
  revoked_at         DateTime?
  ip_address         String?
  user_agent         String?
  digital_signature  String?
  witness_partner_id String?
  expiry_date        DateTime?
  auto_renewal       Boolean   @default(false)
  created_at         DateTime  @default(now())
  updated_at         DateTime  @default(now())
  Dog                Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User               User      @relation(fields: [user_id], references: [id], onDelete: Cascade)
  Partner            Partner?  @relation(fields: [witness_partner_id], references: [id])

  @@index([consent_type, consent_status])
  @@index([expiry_date])
  @@index([user_id, dog_id])
}

model DiaryComment {
  id             String     @id
  diary_entry_id String
  user_id        String
  content        String
  created_at     DateTime   @default(now())
  updated_at     DateTime   @default(now())
  DiaryEntry     DiaryEntry @relation(fields: [diary_entry_id], references: [id], onDelete: Cascade)
  User           User       @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([diary_entry_id])
  @@index([user_id])
}

model DiaryEntry {
  id             String         @id
  dog_id         String
  user_id        String
  title          String
  content        String
  entry_type     String         @default("general")
  milestone_type String?
  photos         Json           @default("[]")
  tags           Json           @default("[]")
  privacy_level  String         @default("public")
  reactions      Json           @default("{}")
  comments_count Int            @default(0)
  likes_count    Int            @default(0)
  shares_count   Int            @default(0)
  is_featured    Boolean        @default(false)
  mood_emoji     String?
  location       String?
  weather        String?
  created_at     DateTime       @default(now())
  updated_at     DateTime       @default(now())
  DiaryComment   DiaryComment[]
  Dog            Dog            @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User           User           @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([dog_id])
  @@index([entry_type])
  @@index([is_featured])
  @@index([privacy_level])
  @@index([user_id])
}

model Dog {
  id                        String                  @id
  name                      String
  breed                     String
  age_months                Int
  weight_kg                 Float
  gender                    String
  vaccination_status        String
  spayed_neutered           Boolean
  microchip_id              String?
  emergency_contact         String?
  emergency_phone           String?
  medical_notes             String?
  personality_traits        String[]
  location                  String?
  photo_url                 String?
  health_id                 String?                 @unique
  user_id                   String
  created_at                DateTime                @default(now())
  updated_at                DateTime                @default(now())
  company_id                String?
  corporate_benefits_active Boolean                 @default(false)
  is_corporate_pet          Boolean                 @default(false)
  AIRecommendation          AIRecommendation[]
  Appointment               Appointment[]
  CommunityQuestion         CommunityQuestion[]
  DataSharingConsent        DataSharingConsent[]
  DiaryEntry                DiaryEntry[]
  Company                   Company?                @relation(fields: [company_id], references: [id])
  User                      User                    @relation(fields: [user_id], references: [id], onDelete: Cascade)
  DogIdVerification         DogIdVerification[]
  DogPhoto                  DogPhoto[]
  DogShare                  DogShare[]
  EmergencyAccessLog        EmergencyAccessLog[]
  EmergencyAlert            EmergencyAlert[]
  EmergencyConsultation     EmergencyConsultation[]
  EmergencyQRCode           EmergencyQRCode?
  ExpertConsultation        ExpertConsultation[]
  HealthAlert               HealthAlert[]
  HealthAnalyticsReport     HealthAnalyticsReport[]
  HealthExport              HealthExport[]
  HealthIdVerification      HealthIdVerification[]
  HealthInsight             HealthInsight[]
  HealthLog                 HealthLog[]
  HealthMetric              HealthMetric[]
  HealthPhoto               HealthPhoto[]
  HealthPrediction          HealthPrediction[]
  HealthReminder            HealthReminder[]
  HealthTrendAnalysis       HealthTrendAnalysis[]
  KCIVerification           KCIVerification[]
  MedicalRecord             MedicalRecord[]
  MedicalRecordAccess       MedicalRecordAccess[]
  MedicalRecordShare        MedicalRecordShare[]
  Medication                Medication[]
  PartnerBooking            PartnerBooking[]
  PartnerReview             PartnerReview[]
  PetBenefitClaim           PetBenefitClaim[]
  SecureDataVault           SecureDataVault[]
  SharingAnalytics          SharingAnalytics[]
  VetAppointment            VetAppointment[]
}

model DogIdVerification {
  id                       String   @id
  dog_id                   String
  partner_id               String
  verification_type        String
  access_reason            String
  health_data_accessed     Json     @default("{}")
  location_coordinates     String?
  ip_address               String?
  user_agent               String?
  session_duration_seconds Int?
  verified_at              DateTime @default(now())
  verified_by              String?
  audit_metadata           Json     @default("{}")
  created_at               DateTime @default(now())
  updated_at               DateTime @default(now())
  Dog                      Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  Partner                  Partner  @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  User                     User?    @relation(fields: [verified_by], references: [id])

  @@index([dog_id, verified_at])
  @@index([partner_id, verified_at])
  @@index([verification_type])
  @@index([verified_at])
}

model DogPhoto {
  id               String   @id
  dog_id           String
  photo_url        String
  caption          String?
  is_profile_photo Boolean  @default(false)
  created_at       DateTime @default(now())
  updated_at       DateTime @default(now())
  Dog              Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([dog_id])
  @@index([is_profile_photo])
}

model DogShare {
  id          String    @id
  dog_id      String
  share_token String    @unique
  share_type  String    @default("public")
  expires_at  DateTime?
  created_by  String
  created_at  DateTime  @default(now())
  Dog         Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
}

model DunningCampaign {
  id                    String        @id
  user_id               String
  subscription_id       String
  payment_retry_id      String?
  campaign_type         String
  status                String        @default("active")
  communication_channel String        @default("email")
  message_template      String?
  scheduled_at          DateTime?
  sent_at               DateTime?
  response_received     Boolean       @default(false)
  response_action       String?
  metadata              Json?
  created_at            DateTime      @default(now())
  updated_at            DateTime
  PaymentRetry          PaymentRetry? @relation(fields: [payment_retry_id], references: [id])
  Subscription          Subscription  @relation(fields: [subscription_id], references: [id], onDelete: Cascade)
  User                  User          @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([campaign_type])
  @@index([payment_retry_id])
  @@index([scheduled_at])
  @@index([status])
  @@index([subscription_id])
  @@index([user_id])
}

model EmergencyAccessLog {
  id                String          @id
  qr_code_id        String
  dog_id            String
  access_type       String
  accessor_info     Json            @default("{}")
  location_data     Json?
  emergency_level   String          @default("normal")
  vet_contacted     String?
  resolution_status String          @default("pending")
  access_timestamp  DateTime        @default(now())
  ip_address        String?
  user_agent        String?
  Dog               Dog             @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  EmergencyQRCode   EmergencyQRCode @relation(fields: [qr_code_id], references: [id], onDelete: Cascade)

  @@index([access_timestamp])
  @@index([dog_id, access_timestamp])
  @@index([emergency_level])
  @@index([qr_code_id])
}

model EmergencyAlert {
  id                   String                @id
  dog_id               String
  qr_code_id           String?
  alert_type           String
  severity             String                @default("medium")
  location_latitude    Decimal?              @db.Decimal(10, 7)
  location_longitude   Decimal?              @db.Decimal(10, 7)
  location_description String?
  description          String
  contact_info         Json                  @default("{}")
  status               String                @default("active")
  assigned_vet_id      String?
  resolution_notes     String?
  created_at           DateTime              @default(now())
  updated_at           DateTime              @default(now())
  resolved_at          DateTime?
  EmergencyVetLocation EmergencyVetLocation? @relation(fields: [assigned_vet_id], references: [id])
  Dog                  Dog                   @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  EmergencyQRCode      EmergencyQRCode?      @relation(fields: [qr_code_id], references: [id])

  @@index([alert_type, severity])
  @@index([dog_id, status])
  @@index([location_latitude, location_longitude])
  @@index([status, created_at])
}

model EmergencyConsultation {
  id                                               String              @id
  user_id                                          String
  dog_id                                           String
  emergency_type                                   String
  severity_level                                   String
  description                                      String
  symptoms                                         String[]            @default([])
  photos                                           String[]            @default([])
  location                                         Json?
  status                                           String              @default("submitted")
  assigned_expert                                  String?
  assigned_at                                      DateTime?
  response_time_minutes                            Int?
  consultation_id                                  String?
  vet_appointment_id                               String?
  immediate_advice                                 String?
  requires_immediate_care                          Boolean             @default(false)
  veterinary_referral                              String?
  follow_up_required                               Boolean             @default(true)
  resolution_notes                                 String?
  satisfaction_rating                              Int?
  is_premium_user                                  Boolean             @default(false)
  credits_used                                     Int                 @default(2)
  created_at                                       DateTime            @default(now())
  resolved_at                                      DateTime?
  User_EmergencyConsultation_assigned_expertToUser User?               @relation("EmergencyConsultation_assigned_expertToUser", fields: [assigned_expert], references: [id])
  ExpertConsultation                               ExpertConsultation? @relation(fields: [consultation_id], references: [id])
  Dog                                              Dog                 @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User_EmergencyConsultation_user_idToUser         User                @relation("EmergencyConsultation_user_idToUser", fields: [user_id], references: [id], onDelete: Cascade)
  VetAppointment                                   VetAppointment?     @relation(fields: [vet_appointment_id], references: [id])

  @@index([assigned_expert])
  @@index([created_at])
  @@index([dog_id])
  @@index([emergency_type])
  @@index([is_premium_user])
  @@index([severity_level])
  @@index([status])
  @@index([user_id])
}

model EmergencyQRCode {
  id                 String               @id
  dog_id             String               @unique
  qr_code            String               @unique
  emergency_data     Json
  access_count       Int                  @default(0)
  last_accessed      DateTime?
  is_active          Boolean              @default(true)
  expires_at         DateTime?
  created_at         DateTime             @default(now())
  updated_at         DateTime             @default(now())
  EmergencyAccessLog EmergencyAccessLog[]
  EmergencyAlert     EmergencyAlert[]
  Dog                Dog                  @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([is_active, expires_at])
  @@index([qr_code])
}

model EmergencyVetLocation {
  id                   String                 @id
  name                 String
  address              String
  city                 String
  state                String
  pincode              String
  phone                String
  emergency_phone      String?
  email                String?
  website              String?
  latitude             Decimal                @db.Decimal(10, 7)
  longitude            Decimal                @db.Decimal(10, 7)
  is_24_hours          Boolean                @default(false)
  services             Json                   @default("[]")
  rating               Decimal?               @db.Decimal(3, 2)
  verified             Boolean                @default(false)
  emergency_capacity   Int                    @default(0)
  current_wait_time    Int                    @default(0)
  accepts_emergency    Boolean                @default(true)
  partner_id           String?
  created_at           DateTime               @default(now())
  updated_at           DateTime               @default(now())
  EmergencyAlert       EmergencyAlert[]
  Partner              Partner?               @relation(fields: [partner_id], references: [id])
  VetEmergencySchedule VetEmergencySchedule[]

  @@index([city, state])
  @@index([is_24_hours, accepts_emergency])
  @@index([latitude, longitude])
  @@index([verified])
}

model EmployeeEnrollment {
  id                  String            @id
  company_id          String
  employee_user_id    String?
  employee_email      String
  employee_name       String?
  department          String?
  enrollment_date     DateTime          @default(now())
  status              String            @default("active")
  pet_allowance_used  Float             @default(0.00)
  pet_allowance_limit Float             @default(5000.00)
  created_at          DateTime          @default(now())
  Company             Company           @relation(fields: [company_id], references: [id], onDelete: Cascade)
  User                User?             @relation(fields: [employee_user_id], references: [id])
  PetBenefitClaim     PetBenefitClaim[]

  @@index([company_id])
  @@index([employee_email])
  @@index([employee_user_id])
}

model ExpertConsultation {
  id                                      String                  @id
  user_id                                 String
  expert_id                               String
  dog_id                                  String?
  consultation_type                       String
  topic                                   String
  category                                String
  question                                String
  expert_response                         String?
  status                                  String                  @default("pending")
  priority                                String                  @default("normal")
  scheduled_at                            DateTime?
  started_at                              DateTime?
  completed_at                            DateTime?
  duration_minutes                        Int?
  rating                                  Int?
  feedback                                String?
  is_premium_feature                      Boolean                 @default(true)
  credits_used                            Int                     @default(1)
  cost                                    Int?
  payment_status                          String                  @default("free")
  meeting_link                            String?
  meeting_password                        String?
  follow_up_required                      Boolean                 @default(false)
  follow_up_scheduled                     DateTime?
  expert_notes                            String?
  attachments                             String[]                @default([])
  tags                                    String[]                @default([])
  is_public                               Boolean                 @default(false)
  view_count                              Int                     @default(0)
  helpful_votes                           Int                     @default(0)
  metadata                                Json?
  created_at                              DateTime                @default(now())
  updated_at                              DateTime
  EmergencyConsultation                   EmergencyConsultation[]
  Dog                                     Dog?                    @relation(fields: [dog_id], references: [id])
  User_ExpertConsultation_expert_idToUser User                    @relation("ExpertConsultation_expert_idToUser", fields: [expert_id], references: [id], onDelete: Cascade)
  User_ExpertConsultation_user_idToUser   User                    @relation("ExpertConsultation_user_idToUser", fields: [user_id], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([consultation_type])
  @@index([created_at])
  @@index([dog_id])
  @@index([expert_id])
  @@index([is_premium_feature])
  @@index([is_public])
  @@index([priority])
  @@index([scheduled_at])
  @@index([status])
  @@index([user_id])
}

model ExpertProfile {
  id                                   String    @id
  user_id                              String    @unique
  expert_type                          String
  specializations                      String[]  @default([])
  qualifications                       String[]  @default([])
  experience_years                     Int?
  verification_status                  String    @default("pending")
  verified_at                          DateTime?
  verified_by                          String?
  consultation_rate                    Int?
  availability_status                  String    @default("available")
  languages                            String[]  @default(["English"])
  bio                                  String?
  expertise_areas                      String[]  @default([])
  consultation_count                   Int       @default(0)
  rating_average                       Float     @default(0.0)
  rating_count                         Int       @default(0)
  response_time_hours                  Int       @default(4)
  max_daily_consultations              Int       @default(10)
  premium_expert                       Boolean   @default(false)
  featured_expert                      Boolean   @default(false)
  education                            Json?
  certifications                       Json?
  social_links                         Json?
  consultation_types                   String[]  @default([])
  created_at                           DateTime  @default(now())
  updated_at                           DateTime
  User_ExpertProfile_user_idToUser     User      @relation("ExpertProfile_user_idToUser", fields: [user_id], references: [id], onDelete: Cascade)
  User_ExpertProfile_verified_byToUser User?     @relation("ExpertProfile_verified_byToUser", fields: [verified_by], references: [id])

  @@index([availability_status])
  @@index([expert_type])
  @@index([featured_expert])
  @@index([premium_expert])
  @@index([rating_average])
  @@index([user_id])
  @@index([verification_status])
}

model FeatureUsageLog {
  id             String         @id
  user_id        String
  feature_id     String
  usage_count    Int            @default(1)
  usage_date     DateTime       @default(now())
  session_data   Json?
  metadata       Json?
  PremiumFeature PremiumFeature @relation(fields: [feature_id], references: [id])
  User           User           @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([feature_id])
  @@index([usage_date])
  @@index([user_id])
}

model Forum {
  id              String   @id
  name            String
  description     String
  category        String
  type            String
  filter_criteria Json     @default("{}")
  moderator_ids   Json     @default("[]")
  post_count      Int      @default(0)
  member_count    Int      @default(0)
  is_active       Boolean  @default(true)
  is_featured     Boolean  @default(false)
  cover_image     String?
  rules           String?
  created_at      DateTime @default(now())
  updated_at      DateTime @default(now())

  @@index([category])
  @@index([created_at])
  @@index([is_active])
  @@index([is_featured])
  @@index([type])
}

model ForumCategory {
  id          String      @id
  name        String
  description String
  slug        String      @unique
  icon        String
  color       String
  is_active   Boolean     @default(true)
  sort_order  Int         @default(0)
  post_count  Int         @default(0)
  created_at  DateTime    @default(now())
  ForumPost   ForumPost[]

  @@index([is_active])
  @@index([slug])
  @@index([sort_order])
}

model ForumPost {
  id               String             @id
  user_id          String
  category_id      String
  title            String
  content          String
  tags             String[]
  is_pinned        Boolean            @default(false)
  is_featured      Boolean            @default(false)
  is_locked        Boolean            @default(false)
  view_count       Int                @default(0)
  like_count       Int                @default(0)
  comment_count    Int                @default(0)
  status           String             @default("active")
  photo_url        String?
  created_at       DateTime           @default(now())
  updated_at       DateTime           @default(now())
  CommunityComment CommunityComment[]
  CommunityFlag    CommunityFlag[]
  ForumCategory    ForumCategory      @relation(fields: [category_id], references: [id])
  User             User               @relation(fields: [user_id], references: [id])

  @@index([category_id])
  @@index([created_at])
  @@index([status])
  @@index([tags])
  @@index([user_id])
}

model HealthAlert {
  id              String    @id
  dog_id          String
  user_id         String
  alert_type      String
  category        String
  title           String
  description     String
  priority        String    @default("medium")
  status          String    @default("active")
  action_required String?
  due_date        DateTime?
  acknowledged_at DateTime?
  resolved_at     DateTime?
  metadata        Json?
  created_at      DateTime  @default(now())
  Dog             Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User            User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([alert_type])
  @@index([category])
  @@index([created_at])
  @@index([dog_id])
  @@index([due_date])
  @@index([priority])
  @@index([status])
  @@index([user_id])
}

model HealthAnalyticsReport {
  id                   String   @id
  dog_id               String
  user_id              String
  report_type          String
  report_period_start  DateTime
  report_period_end    DateTime
  overall_health_score Int
  trends_analysis      Json
  predictions          Json
  recommendations      Json
  insights             Json
  alerts               Json
  generated_at         DateTime @default(now())
  is_premium           Boolean  @default(true)
  metadata             Json?
  Dog                  Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User                 User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([dog_id])
  @@index([generated_at])
  @@index([overall_health_score])
  @@index([report_type])
  @@index([user_id])
}

model HealthExport {
  id               String   @id
  dog_id           String
  user_id          String
  export_type      String
  date_range_start DateTime
  date_range_end   DateTime
  data_types       String[]
  file_url         String?
  file_size        Int?
  status           String   @default("processing")
  download_count   Int      @default(0)
  expires_at       DateTime
  error_message    String?
  created_at       DateTime @default(now())
  Dog              Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User             User     @relation(fields: [user_id], references: [id])

  @@index([dog_id])
  @@index([expires_at])
  @@index([export_type])
  @@index([status])
  @@index([user_id])
}

model HealthIdVerification {
  id                String   @id
  partner_id        String
  dog_id            String
  verification_date DateTime @default(now())
  purpose           String?
  notes             String?
  verified_by       String
  Dog               Dog      @relation(fields: [dog_id], references: [id])
  Partner           Partner  @relation(fields: [partner_id], references: [id], onDelete: Cascade)

  @@index([dog_id])
  @@index([partner_id])
  @@index([verification_date])
}

model HealthInsight {
  id               String    @id
  dog_id           String
  insight_type     String
  category         String
  title            String
  description      String
  severity         String    @default("info")
  data_points      Json?
  recommendations  String[]
  is_read          Boolean   @default(false)
  is_dismissed     Boolean   @default(false)
  confidence_score Float?
  created_at       DateTime  @default(now())
  expires_at       DateTime?
  Dog              Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([category])
  @@index([created_at])
  @@index([dog_id])
  @@index([insight_type])
  @@index([is_read])
}

model HealthLog {
  id                  String   @id
  dog_id              String
  user_id             String
  log_date            DateTime @db.Date
  food_amount         Float?
  food_type           String?
  water_intake        Float?
  exercise_duration   Int?
  exercise_type       String?
  bathroom_frequency  Int?
  weight_kg           Float?
  temperature_celsius Float?
  notes               String?
  photos              Json     @default("[]")
  created_at          DateTime @default(now())
  updated_at          DateTime @default(now())
  appetite_level      Int?
  energy_level        Int?
  symptoms            Json     @default("[]")
  mood_score          Int?
  Dog                 Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User                User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([dog_id, log_date])
  @@index([created_at])
  @@index([dog_id])
  @@index([log_date])
  @@index([user_id])
}

model HealthMetric {
  id               String   @id
  dog_id           String
  user_id          String
  metric_type      String
  value            Float
  unit             String
  measurement_date DateTime
  notes            String?
  measured_by      String?
  device_used      String?
  created_at       DateTime @default(now())
  Dog              Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User             User     @relation(fields: [user_id], references: [id])

  @@index([dog_id])
  @@index([measurement_date])
  @@index([metric_type])
}

model HealthPhoto {
  id                String   @id
  dog_id            String
  user_id           String
  photo_url         String
  thumbnail_url     String?
  photo_type        String
  title             String?
  description       String?
  tags              String[]
  health_log_id     String?
  medical_record_id String?
  taken_at          DateTime
  location          String?
  visibility        String   @default("private")
  created_at        DateTime @default(now())
  Dog               Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User              User     @relation(fields: [user_id], references: [id])

  @@index([dog_id])
  @@index([health_log_id])
  @@index([medical_record_id])
  @@index([photo_type])
  @@index([taken_at])
}

model HealthPrediction {
  id                  String   @id
  dog_id              String
  prediction_type     String
  predicted_condition String?
  risk_level          String
  confidence_score    Float
  prediction_data     Json
  recommendations     Json
  verified_by_expert  Boolean  @default(false)
  expert_notes        String?
  status              String   @default("active")
  prediction_date     DateTime
  created_at          DateTime @default(now())
  updated_at          DateTime @default(now())
  Dog                 Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([dog_id])
  @@index([prediction_date])
  @@index([prediction_type])
  @@index([risk_level])
  @@index([status])
}

model HealthReminder {
  id              String    @id
  dog_id          String
  user_id         String
  reminder_type   String
  title           String
  description     String?
  medication_name String?
  dosage          String?
  frequency       String
  reminder_time   String?
  days_of_week    String[]
  start_date      DateTime
  end_date        DateTime?
  next_reminder   DateTime
  last_reminded   DateTime?
  is_active       Boolean   @default(true)
  auto_complete   Boolean   @default(false)
  reminder_count  Int       @default(0)
  max_reminders   Int?
  snooze_until    DateTime?
  created_at      DateTime  @default(now())
  updated_at      DateTime  @default(now())
  Dog             Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User            User      @relation(fields: [user_id], references: [id])

  @@index([dog_id])
  @@index([is_active])
  @@index([next_reminder])
  @@index([reminder_type])
  @@index([user_id])
}

model HealthTrendAnalysis {
  id              String   @id
  dog_id          String
  trend_type      String
  trend_direction String
  trend_strength  String
  period_start    DateTime
  period_end      DateTime
  data_points     Json
  trend_insights  Json
  recommendations Json
  alerts          Json
  created_at      DateTime @default(now())
  Dog             Dog      @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([dog_id])
  @@index([period_end])
  @@index([period_start])
  @@index([trend_direction])
  @@index([trend_type])
}

model Invoice {
  id              String        @id
  invoice_number  String        @unique
  user_id         String
  subscription_id String?
  payment_id      String?
  status          String        @default("draft")
  invoice_date    DateTime      @default(now())
  due_date        DateTime
  subtotal        Float
  gst_amount      Float
  total_amount    Float
  currency        String        @default("INR")
  payment_method  String?
  paid_at         DateTime?
  gst_details     Json
  line_items      Json
  metadata        Json?
  created_at      DateTime      @default(now())
  updated_at      DateTime
  Payment         Payment?      @relation(fields: [payment_id], references: [id])
  Subscription    Subscription? @relation(fields: [subscription_id], references: [id])
  User            User          @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([due_date])
  @@index([invoice_date])
  @@index([payment_id])
  @@index([status])
  @@index([subscription_id])
  @@index([user_id])
}

model KCIVerification {
  id                  String    @id
  partner_id          String?
  dog_id              String?
  kci_registration_id String    @unique
  breed               String
  dog_name            String?
  owner_name          String?
  registration_date   DateTime?
  verification_status String    @default("pending")
  verification_data   Json?
  verified_at         DateTime?
  created_at          DateTime  @default(now())
  Dog                 Dog?      @relation(fields: [dog_id], references: [id])
  Partner             Partner?  @relation(fields: [partner_id], references: [id])

  @@index([breed])
  @@index([kci_registration_id])
  @@index([verification_status])
}

model MedicalRecord {
  id                 String    @id
  dog_id             String
  user_id            String
  record_type        String
  record_date        DateTime
  title              String
  description        String?
  vet_name           String?
  vet_clinic         String?
  vet_contact        String?
  medications        Json?
  next_due_date      DateTime?
  documents          Json?
  photos             Json?
  cost               Float?
  diagnosis          String?
  treatment_plan     String?
  follow_up_required Boolean   @default(false)
  created_at         DateTime  @default(now())
  updated_at         DateTime  @default(now())
  Dog                Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User               User      @relation(fields: [user_id], references: [id])

  @@index([dog_id])
  @@index([next_due_date])
  @@index([record_date])
  @@index([record_type])
}

model MedicalRecordAccess {
  id                      String             @id
  share_id                String
  dog_id                  String
  accessor_partner_id     String?
  accessor_email          String?
  access_type             String
  record_id               String?
  record_type             String?
  data_accessed           Json               @default("{}")
  access_reason           String?
  consent_verified        Boolean            @default(false)
  ip_address              String?
  user_agent              String?
  session_id              String?
  compliance_flags        Json               @default("{}")
  access_duration_seconds Int?
  created_at              DateTime           @default(now())
  Partner                 Partner?           @relation(fields: [accessor_partner_id], references: [id])
  Dog                     Dog                @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  MedicalRecordShare      MedicalRecordShare @relation(fields: [share_id], references: [id], onDelete: Cascade)

  @@index([access_type])
  @@index([accessor_partner_id])
  @@index([dog_id, created_at])
  @@index([share_id, created_at])
}

model MedicalRecordShare {
  id                     String                @id
  dog_id                 String
  shared_by_user_id      String
  shared_with_partner_id String?
  shared_with_email      String?
  share_type             String
  access_level           String                @default("read_only")
  record_ids             Json                  @default("[]")
  permissions            Json                  @default("{}")
  share_token            String?               @unique
  expires_at             DateTime?
  is_active              Boolean               @default(true)
  consent_given          Boolean               @default(false)
  consent_timestamp      DateTime?
  consent_ip_address     String?
  revoked_at             DateTime?
  revoked_reason         String?
  created_at             DateTime              @default(now())
  updated_at             DateTime              @default(now())
  MedicalRecordAccess    MedicalRecordAccess[]
  Dog                    Dog                   @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  User                   User                  @relation(fields: [shared_by_user_id], references: [id], onDelete: Cascade)
  Partner                Partner?              @relation(fields: [shared_with_partner_id], references: [id], onDelete: Cascade)

  @@index([dog_id, is_active])
  @@index([expires_at])
  @@index([share_token])
  @@index([shared_with_partner_id])
}

model Medication {
  id              String    @id
  dog_id          String
  name            String
  dosage          String?
  frequency       String
  start_date      DateTime  @db.Date
  end_date        DateTime? @db.Date
  prescribed_by   String?
  instructions    String?
  reminder_times  Json      @default("[]")
  is_active       Boolean   @default(true)
  medication_type String    @default("oral")
  side_effects    String?
  created_at      DateTime  @default(now())
  updated_at      DateTime  @default(now())
  Dog             Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  Partner         Partner?  @relation(fields: [prescribed_by], references: [id])

  @@index([dog_id])
  @@index([end_date])
  @@index([is_active])
  @@index([prescribed_by])
  @@index([start_date])
}

model Partner {
  id                                                                               String                     @id
  email                                                                            String                     @unique
  name                                                                             String
  password                                                                         String?
  partner_type                                                                     String
  business_name                                                                    String?
  license_number                                                                   String?
  specialization                                                                   Json?
  experience_years                                                                 Int?
  location                                                                         String
  address                                                                          String?
  phone                                                                            String
  website                                                                          String?
  bio                                                                              String?
  services_offered                                                                 Json?
  pricing_info                                                                     Json?
  availability_schedule                                                            Json?
  languages_spoken                                                                 String[]
  certifications                                                                   String[]
  verified                                                                         Boolean                    @default(false)
  verification_date                                                                DateTime?
  status                                                                           String                     @default("pending")
  admin_notes                                                                      String?
  health_id_access                                                                 Boolean                    @default(false)
  profile_image_url                                                                String?
  partnership_tier                                                                 String                     @default("basic")
  kci_verified                                                                     Boolean                    @default(false)
  kci_registration_id                                                              String?
  rating_average                                                                   Float                      @default(0.0)
  rating_count                                                                     Int                        @default(0)
  commission_rate                                                                  Float                      @default(0.0)
  subscription_status                                                              String                     @default("active")
  subscription_expires                                                             DateTime?
  monthly_revenue                                                                  Float                      @default(0.0)
  total_appointments                                                               Int                        @default(0)
  dog_id_integrated                                                                Boolean                    @default(false)
  total_reviews                                                                    Int                        @default(0)
  consultation_fee_range                                                           Json?
  emergency_available                                                              Boolean                    @default(false)
  home_visit_available                                                             Boolean                    @default(false)
  online_consultation                                                              Boolean                    @default(false)
  response_time_hours                                                              Int?
  service_radius_km                                                                Int?
  languages_primary                                                                String                     @default("english")
  verification_documents                                                           Json?
  social_media_links                                                               Json?
  business_hours                                                                   Json?
  holiday_schedule                                                                 Json?
  cancellation_policy                                                              String?
  refund_policy                                                                    String?
  terms_conditions                                                                 String?
  last_active_at                                                                   DateTime                   @default(now())
  created_at                                                                       DateTime                   @default(now())
  updated_at                                                                       DateTime
  api_rate_limit                                                                   Int                        @default(100)
  compliance_status                                                                String                     @default("pending")
  digital_certificate_hash                                                         String?
  dog_id_access_level                                                              String                     @default("basic")
  emergency_access_enabled                                                         Boolean                    @default(false)
  last_dog_id_access                                                               DateTime?
  mfa_enabled                                                                      Boolean                    @default(false)
  total_verifications_count                                                        Int                        @default(0)
  Appointment                                                                      Appointment[]
  CommissionEarning                                                                CommissionEarning[]
  CommunityExpert                                                                  CommunityExpert[]
  DataSharingConsent                                                               DataSharingConsent[]
  DogIdVerification                                                                DogIdVerification[]
  EmergencyVetLocation                                                             EmergencyVetLocation[]
  HealthIdVerification                                                             HealthIdVerification[]
  KCIVerification                                                                  KCIVerification[]
  MedicalRecordAccess                                                              MedicalRecordAccess[]
  MedicalRecordShare                                                               MedicalRecordShare[]
  Medication                                                                       Medication[]
  PartnerBooking                                                                   PartnerBooking[]
  PartnerNetworkConnection_PartnerNetworkConnection_requesting_partner_idToPartner PartnerNetworkConnection[] @relation("PartnerNetworkConnection_requesting_partner_idToPartner")
  PartnerNetworkConnection_PartnerNetworkConnection_target_partner_idToPartner     PartnerNetworkConnection[] @relation("PartnerNetworkConnection_target_partner_idToPartner")
  PartnerNotification                                                              PartnerNotification[]
  PartnerReview                                                                    PartnerReview[]
  SecurityAuditLog                                                                 SecurityAuditLog[]
  SharingAnalytics                                                                 SharingAnalytics[]
  VetAppointment                                                                   VetAppointment[]
  VetAppointmentSlot                                                               VetAppointmentSlot[]
  VetPartnerProfile                                                                VetPartnerProfile?

  @@index([emergency_available])
  @@index([home_visit_available])
  @@index([kci_verified])
  @@index([last_active_at])
  @@index([location])
  @@index([online_consultation])
  @@index([partner_type])
  @@index([partnership_tier])
  @@index([rating_average])
  @@index([status])
  @@index([verified])
}

model PartnerBooking {
  id                   String          @id
  partner_id           String
  user_id              String
  dog_id               String?
  service_type         String
  booking_type         String
  appointment_datetime DateTime
  duration_minutes     Int             @default(60)
  status               String          @default("pending")
  notes                String?
  user_notes           String?
  partner_notes        String?
  price                Float?
  commission_amount    Float?
  payment_status       String          @default("pending")
  payment_method       String?
  payment_id           String?
  emergency_level      String?
  symptoms             String[]
  preferred_language   String?
  special_requirements String?
  follow_up_required   Boolean         @default(false)
  follow_up_date       DateTime?
  cancelled_by         String?
  cancellation_reason  String?
  cancelled_at         DateTime?
  refund_amount        Float?
  refund_processed_at  DateTime?
  created_at           DateTime        @default(now())
  updated_at           DateTime        @default(now())
  Dog                  Dog?            @relation(fields: [dog_id], references: [id])
  Partner              Partner         @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  User                 User            @relation(fields: [user_id], references: [id])
  PartnerReview        PartnerReview[]

  @@index([appointment_datetime])
  @@index([booking_type])
  @@index([created_at])
  @@index([dog_id])
  @@index([partner_id])
  @@index([payment_status])
  @@index([service_type])
  @@index([status])
  @@index([user_id])
}

model PartnerCommission {
  id                String         @id
  partner_id        String
  partner_type      String
  user_id           String
  service_type      String
  base_amount       Int
  commission_rate   Float
  commission_amount Int
  status            String         @default("pending")
  reference_id      String
  reference_type    String
  payout_id         String?
  metadata          Json?
  created_at        DateTime       @default(now())
  updated_at        DateTime       @default(now())
  PartnerPayout     PartnerPayout? @relation(fields: [payout_id], references: [id])
  User              User           @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([partner_id])
  @@index([partner_type])
  @@index([service_type])
  @@index([status])
  @@index([user_id])
}

model PartnerNetworkConnection {
  id                                                              String    @id
  requesting_partner_id                                           String
  target_partner_id                                               String
  connection_type                                                 String
  status                                                          String    @default("pending")
  permissions                                                     Json      @default("{}")
  trust_level                                                     Int       @default(50)
  approved_by                                                     String?
  approved_at                                                     DateTime?
  last_interaction                                                DateTime?
  interaction_count                                               Int       @default(0)
  created_at                                                      DateTime  @default(now())
  updated_at                                                      DateTime  @default(now())
  User                                                            User?     @relation(fields: [approved_by], references: [id])
  Partner_PartnerNetworkConnection_requesting_partner_idToPartner Partner   @relation("PartnerNetworkConnection_requesting_partner_idToPartner", fields: [requesting_partner_id], references: [id], onDelete: Cascade)
  Partner_PartnerNetworkConnection_target_partner_idToPartner     Partner   @relation("PartnerNetworkConnection_target_partner_idToPartner", fields: [target_partner_id], references: [id], onDelete: Cascade)

  @@unique([requesting_partner_id, target_partner_id])
  @@index([requesting_partner_id])
  @@index([status])
  @@index([target_partner_id])
}

model PartnerNotification {
  id                String    @id
  partner_id        String
  notification_type String
  title             String
  message           String
  action_url        String?
  priority          String    @default("normal")
  read_at           DateTime?
  created_at        DateTime  @default(now())
  Partner           Partner   @relation(fields: [partner_id], references: [id], onDelete: Cascade)

  @@index([notification_type])
  @@index([partner_id, created_at])
  @@index([priority])
  @@index([read_at])
}

model PartnerPayout {
  id                String              @id
  partner_id        String
  partner_type      String
  total_amount      Int
  payout_method     String
  status            String              @default("processing")
  commission_ids    Json
  metadata          Json?
  processed_at      DateTime?
  created_at        DateTime            @default(now())
  updated_at        DateTime            @default(now())
  PartnerCommission PartnerCommission[]

  @@index([created_at])
  @@index([partner_id])
  @@index([partner_type])
  @@index([status])
}

model PartnerReview {
  id                 String          @id
  partner_id         String
  user_id            String
  dog_id             String?
  appointment_id     String?
  partner_booking_id String?
  rating             Int
  review_text        String?
  service_type       String?
  service_quality    Int?
  communication      Int?
  punctuality        Int?
  overall_experience Int?
  would_recommend    Boolean?
  is_verified        Boolean         @default(false)
  is_featured        Boolean         @default(false)
  admin_approved     Boolean         @default(false)
  photos             String[]
  created_at         DateTime        @default(now())
  updated_at         DateTime        @default(now())
  Appointment        Appointment?    @relation(fields: [appointment_id], references: [id])
  Dog                Dog?            @relation(fields: [dog_id], references: [id])
  PartnerBooking     PartnerBooking? @relation(fields: [partner_booking_id], references: [id])
  Partner            Partner         @relation(fields: [partner_id], references: [id], onDelete: Cascade)
  User               User            @relation(fields: [user_id], references: [id])

  @@unique([user_id, partner_id, appointment_id])
  @@index([admin_approved])
  @@index([created_at])
  @@index([is_featured])
  @@index([partner_id])
  @@index([rating])
}

model Payment {
  id                  String           @id
  user_id             String
  subscription_id     String?
  razorpay_payment_id String?
  razorpay_order_id   String           @unique
  amount              Int
  currency            String           @default("INR")
  status              String           @default("created")
  payment_method      String?
  metadata            Json?
  created_at          DateTime         @default(now())
  updated_at          DateTime         @default(now())
  Invoice             Invoice[]
  Subscription        Subscription?    @relation(fields: [subscription_id], references: [id])
  User                User             @relation(fields: [user_id], references: [id], onDelete: Cascade)
  PaymentRetry        PaymentRetry[]
  VetAppointment      VetAppointment[]

  @@index([created_at])
  @@index([razorpay_payment_id])
  @@index([status])
  @@index([subscription_id])
  @@index([user_id])
}

model PaymentRetry {
  id                  String            @id
  subscription_id     String
  payment_id          String?
  user_id             String
  attempt_number      Int               @default(1)
  max_attempts        Int               @default(3)
  status              String            @default("pending")
  payment_method      String
  amount              Float
  currency            String            @default("INR")
  next_retry_date     DateTime?
  grace_period_end    DateTime?
  grace_period_active Boolean           @default(false)
  communication_sent  Boolean           @default(false)
  retry_reason        String?
  error_message       String?
  razorpay_order_id   String?
  metadata            Json?
  created_at          DateTime          @default(now())
  updated_at          DateTime
  DunningCampaign     DunningCampaign[]
  Payment             Payment?          @relation(fields: [payment_id], references: [id])
  Subscription        Subscription      @relation(fields: [subscription_id], references: [id], onDelete: Cascade)
  User                User              @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([grace_period_end])
  @@index([next_retry_date])
  @@index([razorpay_order_id])
  @@index([status])
  @@index([subscription_id])
  @@index([user_id])
}

model PerformanceMetric {
  id                String   @id
  metric_name       String
  metric_value      Float
  measurement_unit  String
  endpoint          String?
  response_time_ms  Int?
  memory_usage_mb   Float?
  cpu_usage_percent Float?
  user_count        Int?
  error_rate        Float?
  timestamp         DateTime @default(now())
  metadata          Json?    @default("{}")

  @@index([endpoint])
  @@index([metric_name])
  @@index([timestamp])
}

model PetBenefitClaim {
  id                     String             @id
  employee_enrollment_id String
  dog_id                 String?
  claim_type             String
  claim_amount           Float
  receipt_url            String?
  claim_date             DateTime           @db.Date
  approval_status        String             @default("pending")
  approved_amount        Float?
  approved_by            String?
  approved_at            DateTime?
  notes                  String?
  created_at             DateTime           @default(now())
  CorporateAdmin         CorporateAdmin?    @relation(fields: [approved_by], references: [id])
  Dog                    Dog?               @relation(fields: [dog_id], references: [id])
  EmployeeEnrollment     EmployeeEnrollment @relation(fields: [employee_enrollment_id], references: [id], onDelete: Cascade)

  @@index([approval_status])
  @@index([claim_date])
  @@index([dog_id])
  @@index([employee_enrollment_id])
}

model PointTransaction {
  id               String     @id
  user_id          String
  points_amount    Int
  transaction_type String
  source           String
  source_id        String?
  description      String
  created_at       DateTime   @default(now())
  User             User       @relation(fields: [user_id], references: [id], onDelete: Cascade)
  UserPoints       UserPoints @relation(fields: [user_id], references: [user_id], onDelete: Cascade, map: "PointTransaction_user_points_fkey")

  @@index([created_at])
  @@index([source])
  @@index([transaction_type])
  @@index([user_id])
}

model PremiumFeature {
  id              String            @id
  feature_key     String            @unique
  name            String
  description     String
  category        String
  required_plan   String
  is_active       Boolean           @default(true)
  usage_limits    Json?
  feature_config  Json?
  created_at      DateTime          @default(now())
  updated_at      DateTime
  FeatureUsageLog FeatureUsageLog[]

  @@index([category])
  @@index([feature_key])
  @@index([is_active])
  @@index([required_plan])
}

model PremiumFeatureUsage {
  id           String   @id
  user_id      String
  feature_name String
  usage_count  Int      @default(1)
  metadata     Json?
  created_at   DateTime @default(now())
  User         User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([feature_name])
  @@index([user_id])
}

model ProfileBackup {
  id         String   @id
  user_id    String
  data       Json
  created_at DateTime @default(now())
  User       User     @relation(fields: [user_id], references: [id], onDelete: Cascade)
}

model PushNotification {
  id            String    @id
  user_id       String?
  title         String
  body          String
  type          String
  action_url    String?
  scheduled_for DateTime?
  sent_at       DateTime?
  delivered_at  DateTime?
  clicked_at    DateTime?
  status        String    @default("pending")
  language      String    @default("en")
  metadata      Json?     @default("{}")
  created_at    DateTime  @default(now())
  User          User?     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([scheduled_for])
  @@index([sent_at])
  @@index([status])
  @@index([type])
  @@index([user_id])
}

model Question {
  id           String   @id
  user_id      String
  dog_id       String?
  title        String
  content      String
  category     String
  is_urgent    Boolean  @default(false)
  upvotes      Int      @default(0)
  answer_count Int      @default(0)
  created_at   DateTime @default(now())
  Answer       Answer[]
  User         User     @relation(fields: [user_id], references: [id])
}

model QuestionView {
  id                  String            @id
  question_id         String
  user_id             String?
  session_fingerprint String
  created_at          DateTime          @default(now())
  CommunityQuestion   CommunityQuestion @relation(fields: [question_id], references: [id], onDelete: Cascade)
  User                User?             @relation(fields: [user_id], references: [id])

  @@index([created_at])
  @@index([question_id])
  @@index([session_fingerprint])
  @@index([user_id])
}

model SearchAnalytics {
  id                      String   @id
  user_id                 String?
  search_query            String
  search_type             String
  language                String   @default("en")
  results_count           Int?
  clicked_result_position Int?
  clicked_result_id       String?
  search_duration_ms      Int?
  no_results              Boolean  @default(false)
  filters_applied         Json?    @default("{}")
  created_at              DateTime @default(now())
  User                    User?    @relation(fields: [user_id], references: [id])

  @@index([created_at])
  @@index([language])
  @@index([no_results])
  @@index([search_type])
  @@index([user_id])
}

model SecureDataVault {
  id                 String    @id
  dog_id             String
  data_type          String
  original_filename  String?
  file_type          String?
  file_size_bytes    Int?
  encryption_key_id  String
  encrypted_data     Bytes?
  encrypted_metadata Json?
  checksum           String
  access_count       Int       @default(0)
  last_accessed      DateTime?
  retention_policy   String    @default("indefinite")
  compliance_level   String    @default("hipaa")
  created_at         DateTime  @default(now())
  updated_at         DateTime  @default(now())
  Dog                Dog       @relation(fields: [dog_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([dog_id, data_type])
  @@index([encryption_key_id])
}

model SecurityAuditLog {
  id                 String   @id
  partner_id         String?
  user_id            String?
  action_type        String
  resource_accessed  String?
  success            Boolean
  failure_reason     String?
  ip_address         String?
  user_agent         String?
  location_country   String?
  location_city      String?
  risk_score         Int      @default(0)
  flagged_for_review Boolean  @default(false)
  created_at         DateTime @default(now())
  Partner            Partner? @relation(fields: [partner_id], references: [id])
  User               User?    @relation(fields: [user_id], references: [id])

  @@index([action_type])
  @@index([flagged_for_review])
  @@index([partner_id, created_at])
  @@index([risk_score, created_at])
  @@index([success])
}

model SharingAnalytics {
  id           String   @id
  dog_id       String?
  partner_id   String?
  share_id     String?
  metric_type  String
  metric_value Int      @default(1)
  metadata     Json     @default("{}")
  date         DateTime @db.Date
  hour         Int?
  created_at   DateTime @default(now())
  Dog          Dog?     @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  Partner      Partner? @relation(fields: [partner_id], references: [id], onDelete: Cascade)

  @@index([date, metric_type])
  @@index([dog_id, date])
  @@index([partner_id, date])
}

model Subscription {
  id                 String               @id
  user_id            String
  plan_type          String
  status             String
  start_date         DateTime
  end_date           DateTime
  trial_end_date     DateTime
  amount_paid        Int
  currency           String               @default("INR")
  billing_cycle      String
  auto_renew         Boolean              @default(true)
  metadata           Json?
  created_at         DateTime             @default(now())
  updated_at         DateTime             @default(now())
  ConsultationCredit ConsultationCredit[]
  CouponUsage        CouponUsage[]
  DunningCampaign    DunningCampaign[]
  Invoice            Invoice[]
  Payment            Payment[]
  PaymentRetry       PaymentRetry[]
  User               User                 @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([created_at])
  @@index([end_date])
  @@index([status])
  @@index([trial_end_date])
  @@index([user_id])
}

model Translation {
  id                  String   @id
  content_id          String
  content_type        String
  original_language   String   @default("en")
  target_language     String
  original_text       String
  translated_text     String
  translation_quality Float?
  is_human_verified   Boolean  @default(false)
  verified_by         String?
  created_at          DateTime @default(now())
  updated_at          DateTime @default(now())

  @@unique([content_id, content_type, target_language])
  @@index([content_id, content_type])
  @@index([original_language])
  @@index([target_language])
}

model User {
  id                                                                String                     @id
  email                                                             String                     @unique
  name                                                              String
  password_hash                                                     String
  location                                                          String?
  experience_level                                                  String                     @default("beginner")
  barks_points                                                      Int                        @default(0)
  is_premium                                                        Boolean                    @default(false)
  profile_image_url                                                 String?
  created_at                                                        DateTime                   @default(now())
  updated_at                                                        DateTime
  preferred_language                                                String                     @default("en")
  profile_visibility                                                String                     @default("public")
  reputation                                                        Int                        @default(0)
  notification_prefs                                                Json?                      @default("{}")
  is_deactivated                                                    Boolean                    @default(false)
  ABTestParticipant                                                 ABTestParticipant[]
  AIRecommendation                                                  AIRecommendation[]
  Answer                                                            Answer[]
  Appointment                                                       Appointment[]
  AuditLog                                                          AuditLog[]
  CommissionEarning                                                 CommissionEarning[]
  CommunityAnswer                                                   CommunityAnswer[]
  CommunityComment                                                  CommunityComment[]
  CommunityExpert_CommunityExpert_user_idToUser                     CommunityExpert[]          @relation("CommunityExpert_user_idToUser")
  CommunityExpert_CommunityExpert_verified_byToUser                 CommunityExpert[]          @relation("CommunityExpert_verified_byToUser")
  CommunityFlag_CommunityFlag_moderator_idToUser                    CommunityFlag[]            @relation("CommunityFlag_moderator_idToUser")
  CommunityFlag_CommunityFlag_user_idToUser                         CommunityFlag[]            @relation("CommunityFlag_user_idToUser")
  CommunityQuestion                                                 CommunityQuestion[]
  CommunityVote                                                     CommunityVote[]
  ComplianceAudit                                                   ComplianceAudit[]
  ConsultationCredit                                                ConsultationCredit[]
  ContentRecommendation                                             ContentRecommendation[]
  CorporateAdmin                                                    CorporateAdmin[]
  CorporateEmployee                                                 CorporateEmployee[]
  CouponUsage                                                       CouponUsage[]
  DataSharingConsent                                                DataSharingConsent[]
  DiaryComment                                                      DiaryComment[]
  DiaryEntry                                                        DiaryEntry[]
  Dog                                                               Dog[]
  DogIdVerification                                                 DogIdVerification[]
  DunningCampaign                                                   DunningCampaign[]
  EmergencyConsultation_EmergencyConsultation_assigned_expertToUser EmergencyConsultation[]    @relation("EmergencyConsultation_assigned_expertToUser")
  EmergencyConsultation_EmergencyConsultation_user_idToUser         EmergencyConsultation[]    @relation("EmergencyConsultation_user_idToUser")
  EmployeeEnrollment                                                EmployeeEnrollment[]
  ExpertConsultation_ExpertConsultation_expert_idToUser             ExpertConsultation[]       @relation("ExpertConsultation_expert_idToUser")
  ExpertConsultation_ExpertConsultation_user_idToUser               ExpertConsultation[]       @relation("ExpertConsultation_user_idToUser")
  ExpertProfile_ExpertProfile_user_idToUser                         ExpertProfile?             @relation("ExpertProfile_user_idToUser")
  ExpertProfile_ExpertProfile_verified_byToUser                     ExpertProfile[]            @relation("ExpertProfile_verified_byToUser")
  FeatureUsageLog                                                   FeatureUsageLog[]
  ForumPost                                                         ForumPost[]
  HealthAlert                                                       HealthAlert[]
  HealthAnalyticsReport                                             HealthAnalyticsReport[]
  HealthExport                                                      HealthExport[]
  HealthLog                                                         HealthLog[]
  HealthMetric                                                      HealthMetric[]
  HealthPhoto                                                       HealthPhoto[]
  HealthReminder                                                    HealthReminder[]
  Invoice                                                           Invoice[]
  MedicalRecord                                                     MedicalRecord[]
  MedicalRecordShare                                                MedicalRecordShare[]
  PartnerBooking                                                    PartnerBooking[]
  PartnerCommission                                                 PartnerCommission[]
  PartnerNetworkConnection                                          PartnerNetworkConnection[]
  PartnerReview                                                     PartnerReview[]
  Payment                                                           Payment[]
  PaymentRetry                                                      PaymentRetry[]
  PointTransaction                                                  PointTransaction[]
  PremiumFeatureUsage                                               PremiumFeatureUsage[]
  ProfileBackup                                                     ProfileBackup[]
  PushNotification                                                  PushNotification[]
  Question                                                          Question[]
  QuestionView                                                      QuestionView[]
  SearchAnalytics                                                   SearchAnalytics[]
  SecurityAuditLog                                                  SecurityAuditLog[]
  Subscription                                                      Subscription[]
  UserBadge                                                         UserBadge[]
  UserBehaviorAnalytics                                             UserBehaviorAnalytics[]
  UserEngagement                                                    UserEngagement[]
  UserFunnel                                                        UserFunnel?
  UserPoints                                                        UserPoints?
  VetAppointment                                                    VetAppointment[]
  event_check_ins                                                   event_check_ins[]
  event_comments                                                    event_comments[]
  event_feedback                                                    event_feedback[]
  event_photo_likes                                                 event_photo_likes[]
  event_photos                                                      event_photos[]
  event_rsvps                                                       event_rsvps[]
  event_series                                                      event_series[]
  event_updates                                                     event_updates[]
  event_waiting_list                                                event_waiting_list[]
  events                                                            events[]
}

model UserBadge {
  id                String   @id
  user_id           String
  badge_type        String
  badge_name        String
  badge_description String
  badge_icon        String
  badge_color       String
  earned_at         DateTime @default(now())
  User              User     @relation(fields: [user_id], references: [id])

  @@index([badge_type])
  @@index([earned_at])
  @@index([user_id])
}

model UserBehaviorAnalytics {
  id                 String   @id
  user_id            String?
  session_id         String
  action_type        String
  page_url           String?
  element_clicked    String?
  time_spent_seconds Int?
  device_type        String?
  browser            String?
  location_city      String?
  language           String   @default("en")
  ab_variant         String?
  referrer           String?
  error_code         String?
  metadata           Json?    @default("{}")
  timestamp          DateTime @default(now())
  User               User?    @relation(fields: [user_id], references: [id])

  @@index([action_type])
  @@index([device_type])
  @@index([language])
  @@index([session_id])
  @@index([timestamp])
  @@index([user_id])
}

model UserEngagement {
  id            String   @id
  user_id       String
  action_type   String
  points_earned Int
  description   String
  related_id    String?
  related_type  String?
  created_at    DateTime @default(now())
  User          User     @relation(fields: [user_id], references: [id])

  @@index([action_type])
  @@index([created_at])
  @@index([user_id])
}

model UserFunnel {
  id                     String    @id
  user_id                String    @unique
  signup_date            DateTime
  profile_completed_at   DateTime?
  dog_profile_created_at DateTime?
  first_question_at      DateTime?
  first_answer_at        DateTime?
  first_health_log_at    DateTime?
  first_booking_at       DateTime?
  premium_signup_at      DateTime?
  current_stage          String    @default("signup")
  language               String    @default("en")
  acquisition_source     String?
  city                   String?
  updated_at             DateTime  @default(now())
  User                   User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([acquisition_source])
  @@index([city])
  @@index([current_stage])
  @@index([language])
  @@index([signup_date])
}

model UserPoints {
  id                    String             @id
  user_id               String             @unique
  points_earned         Int                @default(0)
  points_spent          Int                @default(0)
  current_balance       Int                @default(0)
  total_lifetime_points Int                @default(0)
  last_daily_bonus      DateTime?
  streak_count          Int                @default(0)
  achievements          Json               @default("[]")
  badges                Json               @default("[]")
  level                 Int                @default(1)
  experience_points     Int                @default(0)
  created_at            DateTime           @default(now())
  updated_at            DateTime           @default(now())
  PointTransaction      PointTransaction[]
  User                  User               @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([current_balance])
  @@index([level])
  @@index([streak_count])
  @@index([user_id])
}

model VetAppointment {
  id                     String                  @id
  dog_id                 String
  vet_id                 String?
  appointment_datetime   DateTime
  reason                 String
  diagnosis              String?
  treatment              String?
  medications_prescribed Json                    @default("[]")
  follow_up_date         DateTime?               @db.Date
  cost                   Float?
  status                 String                  @default("scheduled")
  notes                  String?
  documents              Json                    @default("[]")
  appointment_type       String                  @default("checkup")
  duration_minutes       Int                     @default(30)
  created_at             DateTime                @default(now())
  updated_at             DateTime                @default(now())
  appointment_time       String?
  booking_source         String                  @default("app")
  consultation_notes     String?
  emergency_consultation Boolean                 @default(false)
  feedback               String?
  follow_up_notes        String?
  is_premium_booking     Boolean                 @default(false)
  meeting_link           String?
  meeting_password       String?
  metadata               Json?
  payment_id             String?
  payment_status         String                  @default("pending")
  prescription           Json?
  priority_level         String                  @default("normal")
  rating                 Int?
  reminder_sent          Boolean                 @default(false)
  slot_id                String?
  user_id                String?
  EmergencyConsultation  EmergencyConsultation[]
  Dog                    Dog                     @relation(fields: [dog_id], references: [id], onDelete: Cascade)
  Payment                Payment?                @relation(fields: [payment_id], references: [id])
  VetAppointmentSlot     VetAppointmentSlot?     @relation(fields: [slot_id], references: [id])
  User                   User?                   @relation(fields: [user_id], references: [id])
  Partner                Partner?                @relation(fields: [vet_id], references: [id])

  @@index([appointment_datetime])
  @@index([appointment_type])
  @@index([dog_id])
  @@index([is_premium_booking])
  @@index([payment_status])
  @@index([priority_level])
  @@index([slot_id])
  @@index([status])
  @@index([user_id])
  @@index([vet_id])
}

model VetAppointmentSlot {
  id               String           @id
  vet_partner_id   String
  slot_date        DateTime
  slot_time        String
  duration_minutes Int              @default(30)
  slot_type        String           @default("regular")
  is_available     Boolean          @default(true)
  is_premium_only  Boolean          @default(false)
  price            Int?
  max_bookings     Int              @default(1)
  current_bookings Int              @default(0)
  created_at       DateTime         @default(now())
  updated_at       DateTime
  VetAppointment   VetAppointment[]
  Partner          Partner          @relation(fields: [vet_partner_id], references: [id], onDelete: Cascade)

  @@unique([vet_partner_id, slot_date, slot_time])
  @@index([is_available])
  @@index([is_premium_only])
  @@index([slot_date])
  @@index([slot_type])
  @@index([vet_partner_id])
}

model VetEmergencySchedule {
  id                   String               @id
  vet_location_id      String
  day_of_week          Int
  open_time            String?
  close_time           String?
  is_24_hours          Boolean              @default(false)
  emergency_only       Boolean              @default(false)
  max_capacity         Int                  @default(10)
  notes                String?
  created_at           DateTime             @default(now())
  updated_at           DateTime             @default(now())
  EmergencyVetLocation EmergencyVetLocation @relation(fields: [vet_location_id], references: [id], onDelete: Cascade)

  @@index([vet_location_id, day_of_week])
}

model VetPartnerProfile {
  id                     String   @id
  partner_id             String   @unique
  specializations        String[] @default([])
  qualifications         String[] @default([])
  experience_years       Int?
  consultation_fee       Int?
  emergency_available    Boolean  @default(false)
  telemedicine_enabled   Boolean  @default(false)
  languages              String[] @default(["English"])
  availability_schedule  Json?
  max_daily_appointments Int      @default(20)
  rating_average         Float    @default(0.0)
  rating_count           Int      @default(0)
  total_consultations    Int      @default(0)
  premium_partner        Boolean  @default(false)
  priority_booking       Boolean  @default(false)
  response_time_hours    Int      @default(24)
  bio                    String?
  education              Json?
  certifications         Json?
  clinic_photos          String[] @default([])
  consultation_types     String[] @default([])
  created_at             DateTime @default(now())
  updated_at             DateTime
  Partner                Partner  @relation(fields: [partner_id], references: [id], onDelete: Cascade)

  @@index([emergency_available])
  @@index([partner_id])
  @@index([premium_partner])
  @@index([rating_average])
  @@index([specializations])
  @@index([telemedicine_enabled])
}

model Waitlist {
  id                 String   @id
  email              String   @unique
  name               String
  location           String?
  phone              String?
  dog_owner          Boolean  @default(false)
  preferred_language String   @default("en")
  referral_source    String?
  interests          String?
  status             String   @default("active")
  position           Int?
  created_at         DateTime @default(now())
  updated_at         DateTime
}

model event_check_ins {
  id              String   @id
  event_id        String
  user_id         String
  check_in_time   DateTime @default(now())
  check_in_method String   @default("manual")
  latitude        Float?
  longitude       Float?
  notes           String?
  events          events   @relation(fields: [event_id], references: [id], onDelete: Cascade)
  User            User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([event_id, user_id])
  @@index([event_id])
  @@index([user_id])
}

model event_comments {
  id                   String           @id
  event_id             String
  user_id              String
  comment              String
  parent_id            String?
  is_approved          Boolean          @default(true)
  created_at           DateTime         @default(now())
  updated_at           DateTime
  events               events           @relation(fields: [event_id], references: [id], onDelete: Cascade)
  event_comments       event_comments?  @relation("event_commentsToevent_comments", fields: [parent_id], references: [id])
  other_event_comments event_comments[] @relation("event_commentsToevent_comments")
  User                 User             @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@index([event_id])
  @@index([parent_id])
  @@index([user_id])
}

model event_feedback {
  id                  String   @id
  event_id            String
  user_id             String
  overall_rating      Int
  venue_rating        Int?
  content_rating      Int?
  organization_rating Int?
  would_recommend     Boolean  @default(true)
  feedback_text       String?
  suggestions         String?
  submitted_at        DateTime @default(now())
  events              events   @relation(fields: [event_id], references: [id], onDelete: Cascade)
  User                User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([event_id, user_id])
  @@index([event_id])
  @@index([user_id])
}

model event_photo_likes {
  id           String       @id
  photo_id     String
  user_id      String
  liked_at     DateTime     @default(now())
  event_photos event_photos @relation(fields: [photo_id], references: [id], onDelete: Cascade)
  User         User         @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([photo_id, user_id])
  @@index([photo_id])
  @@index([user_id])
}

model event_photos {
  id                String              @id
  event_id          String
  uploaded_by       String
  photo_url         String
  thumbnail_url     String?
  caption           String?
  tagged_users      String[]            @default([])
  is_featured       Boolean             @default(false)
  is_approved       Boolean             @default(true)
  uploaded_at       DateTime            @default(now())
  width             Int?
  height            Int?
  file_size         Int?
  camera_info       Json?
  event_photo_likes event_photo_likes[]
  events            events              @relation(fields: [event_id], references: [id], onDelete: Cascade)
  User              User                @relation(fields: [uploaded_by], references: [id], onDelete: Cascade)

  @@index([event_id])
  @@index([is_featured])
  @@index([uploaded_by])
}

model event_rsvps {
  id                   String   @id
  event_id             String
  user_id              String
  status               String   @default("confirmed")
  rsvp_date            DateTime @default(now())
  guest_count          Int      @default(0)
  guest_names          String[] @default([])
  special_requirements String?
  payment_status       String?  @default("pending")
  payment_id           String?
  email_reminders      Boolean  @default(true)
  sms_reminders        Boolean  @default(false)
  push_reminders       Boolean  @default(true)
  created_at           DateTime @default(now())
  updated_at           DateTime
  events               events   @relation(fields: [event_id], references: [id], onDelete: Cascade)
  User                 User     @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([event_id, user_id])
  @@index([event_id])
  @@index([status])
  @@index([user_id])
}

model event_series {
  id                String   @id
  name              String
  description       String
  organizer_id      String
  is_active         Boolean  @default(true)
  created_at        DateTime @default(now())
  frequency         String
  recurring_pattern Json
  User              User     @relation(fields: [organizer_id], references: [id])

  @@index([is_active])
  @@index([organizer_id])
}

model event_updates {
  id          String   @id
  event_id    String
  title       String
  message     String
  update_type String   @default("general")
  sent_to     String   @default("all")
  created_by  String
  created_at  DateTime @default(now())
  User        User     @relation(fields: [created_by], references: [id])
  events      events   @relation(fields: [event_id], references: [id], onDelete: Cascade)

  @@index([created_by])
  @@index([event_id])
  @@index([update_type])
}

model event_waiting_list {
  id          String    @id
  event_id    String
  user_id     String
  position    Int
  joined_at   DateTime  @default(now())
  notified_at DateTime?
  promoted_at DateTime?
  status      String    @default("waiting")
  events      events    @relation(fields: [event_id], references: [id], onDelete: Cascade)
  User        User      @relation(fields: [user_id], references: [id], onDelete: Cascade)

  @@unique([event_id, user_id])
  @@index([event_id])
  @@index([status])
  @@index([user_id])
}

model events {
  id                    String               @id
  title                 String
  description           String
  event_type            String
  category              String
  status                String               @default("draft")
  is_virtual            Boolean              @default(false)
  is_premium_only       Boolean              @default(false)
  is_featured           Boolean              @default(false)
  start_date            DateTime
  end_date              DateTime
  timezone              String               @default("Asia/Kolkata")
  registration_start    DateTime?
  registration_end      DateTime?
  max_participants      Int?
  current_participants  Int                  @default(0)
  waiting_list_enabled  Boolean              @default(true)
  allow_guests          Boolean              @default(false)
  max_guests_per_user   Int                  @default(1)
  venue_name            String?
  address               String?
  city                  String
  state                 String               @default("Maharashtra")
  country               String               @default("India")
  latitude              Float?
  longitude             Float?
  virtual_link          String?
  is_free               Boolean              @default(true)
  price                 Int?
  currency              String               @default("INR")
  refund_policy         String?
  agenda                Json?
  requirements          String[]             @default([])
  tags                  String[]             @default([])
  cover_image_url       String?
  additional_images     String[]             @default([])
  organizer_id          String
  co_organizers         String[]             @default([])
  partner_organizations String[]             @default([])
  auto_approve_rsvp     Boolean              @default(true)
  send_reminders        Boolean              @default(true)
  allow_photos          Boolean              @default(true)
  is_recurring          Boolean              @default(false)
  recurring_pattern     Json?
  created_at            DateTime             @default(now())
  updated_at            DateTime
  event_check_ins       event_check_ins[]
  event_comments        event_comments[]
  event_feedback        event_feedback[]
  event_photos          event_photos[]
  event_rsvps           event_rsvps[]
  event_updates         event_updates[]
  event_waiting_list    event_waiting_list[]
  User                  User                 @relation(fields: [organizer_id], references: [id])

  @@index([category])
  @@index([city])
  @@index([event_type])
  @@index([is_featured])
  @@index([is_premium_only])
  @@index([organizer_id])
  @@index([start_date])
  @@index([status])
}

model venues {
  id              String   @id
  name            String
  description     String?
  address         String
  city            String
  state           String
  country         String   @default("India")
  postal_code     String?
  latitude        Float?
  longitude       Float?
  capacity        Int?
  facilities      String[] @default([])
  contact_info    Json?
  photos          String[] @default([])
  is_verified     Boolean  @default(false)
  is_pet_friendly Boolean  @default(true)
  created_at      DateTime @default(now())

  @@index([city])
  @@index([is_pet_friendly])
  @@index([is_verified])
  @@index([state])
}
